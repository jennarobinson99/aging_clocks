group = factor(c(1, 1,1, 2, 2, 2))
group
x <- ~group
x
print(x)
x <- ~ 0+group
x
model.matrix(~0+group)
model.matrix(~group)
getwd()
setwd("D:/proj_epigen/aging_clocks")
bg1 <- read.csv("data/G4_maps/BG4_peaks_2016.csv")
View(bg1)
bg1 <- read.csv("data/G4_maps/BG4_peaks_2016.csv", sep = ";")
bg2 <- read.csv("data/G4_maps/BG4_peaks_2018.csv", sep = ";")
View(bg2)
bg1 <-  bg1[c(1, 2, 3),]
bg1 <- read.csv("data/G4_maps/BG4_peaks_2016.csv", sep = ";")
bg1 <-  bg1[,c(1, 2, 3)]
bg2 <-  bg2[,c(1, 2, 3)]
write.table(bg1, file="BG4_peaks_2016.bed", quote=F, sep=" ")
write.table(bg1, file="BG4_peaks_2016.bed", quote=F, sep=" ", row.names = F, col.names = F)
write.table(bg1, file="data/G4_maps/BG4_peaks_2016.bed", quote=F, sep=" ", row.names = F, col.names = F)
write.table(bg2, file="data/G4_maps/BG4_peaks_2018.bed", quote=F, sep=" ", row.names=F, col.names = F)
write.table(bg1, file="data/G4_maps/BG4_peaks_2016.bed", quote=F, sep=" ", row.names = F, col.names = F)
bg1 <- read.csv("data/G4_maps/BG4_peaks_2016.csv", sep = ";")
bg2 <- read.csv("data/G4_maps/BG4_peaks_2018.csv", sep = ";")
bg1 <-  bg1[,c(1, 2, 3, 6)]
bg2 <-  bg2[,c(1, 2, 3, 4)]
write.table(bg1, file="data/G4_maps/BG4_peaks_2016.bed", quote=F, sep=" ", row.names = F, col.names = F)
write.table(bg2, file="data/G4_maps/BG4_peaks_2018.bed", quote=F, sep=" ", row.names=F, col.names = F)
sort(bg1)
?sort
library(dplyr)
bg1 <- bg1 %>% arrange(chr, start)
names(bg1) <- c(chr, start, end, methylation)
names(bg1) <- c("chr", "start", "end", "methylation")
names(bg1) <- c("chr", "start", "end", "FC")
names(bg2) <- c("chr", "start", "end", "methylation")
bg1 <- bg1 %>% arrange(chr, start)
bg2 <- bg2 %>% arrange(chr, start)
write.table(bg2, file="data/G4_maps/BG4_peaks_2018.bed", quote=F, sep=" ", row.names=F, col.names = F)
write.table(bg1, file="data/G4_maps/BG4_peaks_2016.bed", quote=F, sep=" ", row.names = F, col.names = F)
write.table(bg1, file="data/G4_maps/BG4_peaks_2016.bed", quote=F, sep="\t", row.names = F, col.names = F)
write.table(bg2, file="data/G4_maps/BG4_peaks_2018.bed", quote=F, sep="\t", row.names=F, col.names = F)
