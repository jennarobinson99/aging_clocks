group = factor(c(1, 1,1, 2, 2, 2))
group
x <- ~group
x
print(x)
x <- ~ 0+group
x
model.matrix(~0+group)
model.matrix(~group)
getwd()
#load the bed file containing genome coordinates
input_file <- "data/CpG_lists/all_CpGs_hg19_ws_50_merged.bed"
setwd("D:/proj_epigen/aging_clocks")
coordinates <- read.csv(input_file, header=F, col.names=c("chr", "start", "end"), sep='\t')
View(coordinates)
#import biostrings and genome
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
library(seqinr)
library(rGADEM)
genome <- BSgenome.Hsapiens.UCSC.hg19
# get sequence from genome
chromosomes <-coordinates[,"chr"]
starts <- coordinates[,"start"]
ends <- coordinates[,"end"]
sequences <- as.list(unname(Biostrings::getSeq(genome, chromosomes, starts, ends, as.character=T)))
View(sequences)
# run motif discovery
GADEM(sequences, seed=1,nmotifs = 5)
?import
# run motif discovery
ranges <- makeGRangesFromDataFrame(coordinates)
gadem <- GADEM(ranges, verbose=1, genome=genome)
View(ranges)
coordinates[247807,]
)
lsajf
;
?GADEM
GADEM
View(coordinates)
View(ranges)
# run motif discovery
ranges <- makeGRangesFromDataFrame(coordinates)
gadem <- GADEM(ranges, verbose=1, genome=genome)
source('D:/proj_epigen/aging_clocks/R_scripts/find_sequences.R', echo=TRUE)
debugSource('D:/proj_epigen/aging_clocks/R_scripts/find_sequences.R', echo=TRUE)
debugSource('D:/proj_epigen/aging_clocks/R_scripts/find_sequences.R')
#load the bed file containing genome coordinates
input_file <- "data/CpG_lists/all_CpGs_mm10_ws_1000_merged.bed"
coordinates <- read.csv(input_file, header=F, col.names=c("chr", "start", "end"), sep='\t')
#import biostrings and genome
library(Biostrings)
library(BSgenome.Mmusculus.UCSC.mm10)
library(seqinr)
library(rGADEM)
genome <- BSgenome.Mmusculus.UCSC.mm10
# get sequence from genome
chromosomes <-coordinates[,"chr"]
starts <- coordinates[,"start"]
ends <- coordinates[,"end"]
# run motif discovery
ranges <- makeGRangesFromDataFrame(coordinates)
gadem <- GADEM(ranges, verbose=1, genome=genome)
gadem <- GADEM(ranges, verbose=2, genome=genome)
# run motif discovery
ranges <- makeGRangesFromDataFrame(coordinates)
gadem <- GADEM(ranges, verbose=1, genome=genome)
gadem <- GADEM(ranges, verbose=1, genome=genome)
debugSource('D:/proj_epigen/aging_clocks/R_scripts/find_sequences.R')
debugSource('D:/proj_epigen/aging_clocks/R_scripts/find_sequences.R')
debugSource('D:/proj_epigen/aging_clocks/R_scripts/find_sequences.R', echo=TRUE)
write.fasta(sequences, identifiers, "sequences/all_CpGs_human.fasta", open="w", as.string=T)
# run motif discovery
ranges <- makeGRangesFromDataFrame(coordinates)
gadem <- GADEM(ranges, verbose=1, genome=genome)
debugSource('D:/proj_epigen/aging_clocks/R_scripts/find_sequences.R', echo=TRUE)
debugSource('D:/proj_epigen/aging_clocks/R_scripts/find_all_CpGs.R', echo=TRUE)
library(BSgenome.Mmusculus.UCSC.mm10)
library(seqinr)
debugSource('D:/proj_epigen/aging_clocks/R_scripts/find_all_CpGs.R', echo=TRUE)
debugSource('D:/proj_epigen/aging_clocks/R_scripts/find_sequences.R', echo=TRUE)
debugSource('D:/proj_epigen/aging_clocks/R_scripts/find_sequences.R', echo=TRUE)
gadem <- GADEM(ranges, verbose=1, genome=Mmusculus)
Mmusculus
View(coordinates)
Mmusculus$chr1
