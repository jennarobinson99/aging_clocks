group = factor(c(1, 1,1, 2, 2, 2))
group
x <- ~group
x
print(x)
x <- ~ 0+group
x
model.matrix(~0+group)
model.matrix(~group)
getwd()
setwd("D:/proj_epigen/aging_clocks")
library(dplyr)
library(rjson)
# FUNCTIONS
source("R_scripts/functions.R")
# load config.json file
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
ATAC_file <- params[["ATAC_file"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
figure_name_window_size <- params[["figure_name_window_size"]]
figure_name_coefficient_dist <- params[["figure_name_coefficient_dist"]]
figure_name_CGI_dist <- params[["figure_name_CGI_dist"]]
figure_name_chromatin_dist <- params[["figure_name_chromatin_dist"]]
all_CpGs_file <- params[["all_CpGs_file"]]
window_sizes <- params[["window_sizes"]]
CGI_map_file <- params[["CGI_map_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
output_file <- params[["output_file"]]
################################################################################
# Enrichment of G4s in all CpGs genome-wide vs. G4s in AC CpGs
G4_locs <- load_G4_data(G4_file_plus = G4_file_plus, narrow_peak = T)
CpG_locs <- read.csv(all_CpGs_file, header=F, sep="\t", col.names = c("chromosome", "start", "end"))
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
# search_set needs to be CpG_locs, cant shuffle such large files
results <- analyse_window_size(query=CpG_locs, search_set=G4_locs, genome_file=genome_file, window_sizes=c(1000, 3000, 5000, 10000, 100000, 1000000), all_CpGs_props=results_all_CpGs, shuffle="s")
plot_results(overlap_results=results, query_name="CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
#figure_name_window_size = figure_name_window_size,
#figure_name_coeff_dist = figure_name_coefficient_dist,
#figure_name_CGI_dist = figure_name_CGI_dist,
figure_name_chromatin_dist = figure_name_chromatin_dist)
write.table(results$stats, file=output_file, sep=";", row.names = F)
results <- analyse_window_size(query=CpG_locs, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs, shuffle="s")
plot_results(overlap_results=results, query_name="CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
#figure_name_window_size = figure_name_window_size,
#figure_name_coeff_dist = figure_name_coefficient_dist,
#figure_name_CGI_dist = figure_name_CGI_dist,
figure_name_chromatin_dist = figure_name_chromatin_dist)
write.table(results$stats, file=output_file, sep=";", row.names = F)
source('D:/proj_epigen/aging_clocks/R_scripts/functions.R', echo=TRUE)
source("R_scripts/functions.R")
# load config.json file
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
ATAC_file <- params[["ATAC_file"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
figure_name_window_size <- params[["figure_name_window_size"]]
figure_name_coefficient_dist <- params[["figure_name_coefficient_dist"]]
figure_name_CGI_dist <- params[["figure_name_CGI_dist"]]
figure_name_chromatin_dist <- params[["figure_name_chromatin_dist"]]
all_CpGs_file <- params[["all_CpGs_file"]]
window_sizes <- params[["window_sizes"]]
CGI_map_file <- params[["CGI_map_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
output_file <- params[["output_file"]]
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
ATAC_file <- params[["ATAC_file"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
figure_name_window_size <- params[["figure_name_window_size"]]
figure_name_coefficient_dist <- params[["figure_name_coefficient_dist"]]
figure_name_CGI_dist <- params[["figure_name_CGI_dist"]]
figure_name_chromatin_dist <- params[["figure_name_chromatin_dist"]]
all_CpGs_file <- params[["all_CpGs_file"]]
window_sizes <- params[["window_sizes"]]
CGI_map_file <- params[["CGI_map_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
output_file <- params[["output_file"]]
G4_locs <- load_G4_data(G4_file_plus = G4_file_plus, narrow_peak = T)
CpG_locs <- read.csv(all_CpGs_file, header=F, sep="\t", col.names = c("chromosome", "start", "end"))
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
# search_set needs to be CpG_locs, cant shuffle such large files
results <- analyse_window_size(query=CpG_locs, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs, shuffle="s")
write.table(results$stats, file=output_file, sep=";", row.names = F)
source('D:/proj_epigen/aging_clocks/R_scripts/functions.R', echo=TRUE)
# search_set needs to be CpG_locs, cant shuffle such large files
results <- analyse_window_size(query=CpG_locs, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs, shuffle="s")
source('D:/proj_epigen/aging_clocks/R_scripts/functions.R', echo=TRUE)
debugSource('D:/proj_epigen/aging_clocks/R_scripts/functions.R', echo=TRUE)
# search_set needs to be CpG_locs, cant shuffle such large files
results <- analyse_window_size(query=CpG_locs, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs, shuffle="s")
force(query)
force(reduce)
force(search_set)
# search_set needs to be CpG_locs, cant shuffle such large files
results <- analyse_window_size(query=CpG_locs, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs, shuffle="s")
debugSource('D:/proj_epigen/aging_clocks/R_scripts/functions.R', echo=TRUE)
debugSource('D:/proj_epigen/aging_clocks/R_scripts/functions.R', echo=TRUE)
# search_set needs to be CpG_locs, cant shuffle such large files
results <- analyse_window_size(query=CpG_locs, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs, shuffle="s")
debugSource('D:/proj_epigen/aging_clocks/R_scripts/functions.R', echo=TRUE)
# search_set needs to be CpG_locs, cant shuffle such large files
results <- analyse_window_size(query=CpG_locs, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs, shuffle="s")
debugSource('D:/proj_epigen/aging_clocks/R_scripts/functions.R', echo=TRUE)
# search_set needs to be CpG_locs, cant shuffle such large files
results <- analyse_window_size(query=CpG_locs, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs, shuffle="s")
debugSource('D:/proj_epigen/aging_clocks/R_scripts/functions.R', echo=TRUE)
library(dplyr)
library(rjson)
# FUNCTIONS
source("R_scripts/functions.R")
# load config.json file
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
ATAC_file <- params[["ATAC_file"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
figure_name_window_size <- params[["figure_name_window_size"]]
figure_name_coefficient_dist <- params[["figure_name_coefficient_dist"]]
figure_name_CGI_dist <- params[["figure_name_CGI_dist"]]
figure_name_chromatin_dist <- params[["figure_name_chromatin_dist"]]
all_CpGs_file <- params[["all_CpGs_file"]]
window_sizes <- params[["window_sizes"]]
CGI_map_file <- params[["CGI_map_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
output_file <- params[["output_file"]]
################################################################################
# Enrichment of G4s in all CpGs genome-wide vs. G4s in AC CpGs
G4_locs <- load_G4_data(G4_file_plus = G4_file_plus, narrow_peak = T)
CpG_locs <- read.csv(all_CpGs_file, header=F, sep="\t", col.names = c("chromosome", "start", "end"))
