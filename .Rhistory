CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_in <- CpG_locs %>% filter(CGI_context=="inside")
CpGs_out <- CpG_locs %>% filter(CGI_context=="outside")
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_in <- analyse_window_size(query=CpGs_in, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_out <- analyse_window_size(query=CpGs_out, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_in$stats, file="out/CGI_in_vs_out/BG4s_HEK/rep2_Horvath_in_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_out$stats, file="out/CGI_in_vs_out/BG4s_HEK/rep2_Horvath_out_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_in, query_name="CpGs in CGIs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/CGI_in_vs_out/BG4s_HEK/rep2_Horvath_in_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/CGI_in_vs_out/BG4s_HEK/rep2_Horvath_in_coeff_dist.pdf",
figure_name_CGI_dist="out/CGI_in_vs_out/BG4s_HEK/redundant.pdf")
plot_results(overlap_results = results_out, query_name="CpGs outside CGIs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/CGI_in_vs_out/BG4s_HEK/rep2_Horvath_out_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/CGI_in_vs_out/BG4s_HEK/rep2_Horvath_out_coeff_dist.pdf",
figure_name_CGI_dist="out/CGI_in_vs_out/BG4s_HEK/rep2_redundant.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = F)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_in <- CpG_locs %>% filter(CGI_context=="inside")
CpGs_out <- CpG_locs %>% filter(CGI_context=="outside")
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_in <- analyse_window_size(query=CpGs_in, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_out <- analyse_window_size(query=CpGs_out, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_in$stats, file="out/CGI_in_vs_out/BG4s_K562/Horvath_in_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_out$stats, file="out/CGI_in_vs_out/BG4s_K562/Horvath_out_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_in, query_name="CpGs in CGIs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/CGI_in_vs_out/BG4s_K562/Horvath_in_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/CGI_in_vs_out/BG4s_K562/Horvath_in_coeff_dist.pdf",
figure_name_CGI_dist="out/CGI_in_vs_out/BG4s_K562/redundant.pdf")
plot_results(overlap_results = results_out, query_name="CpGs outside CGIs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/CGI_in_vs_out/BG4s_K562/Horvath_out_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/CGI_in_vs_out/BG4s_K562/Horvath_out_coeff_dist.pdf",
figure_name_CGI_dist="out/CGI_in_vs_out/BG4s_K562/redundant.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = F)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_in <- CpG_locs %>% filter(CGI_context=="inside")
CpGs_out <- CpG_locs %>% filter(CGI_context=="outside")
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_in <- analyse_window_size(query=CpGs_in, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_out <- analyse_window_size(query=CpGs_out, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_in$stats, file="out/CGI_in_vs_out/BG4s_K562/Levine_in_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_out$stats, file="out/CGI_in_vs_out/BG4s_K562/Levine_out_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_in, query_name="CpGs in CGIs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/CGI_in_vs_out/BG4s_K562/Levine_in_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/CGI_in_vs_out/BG4s_K562/Levine_in_coeff_dist.pdf",
figure_name_CGI_dist="out/CGI_in_vs_out/BG4s_K562/redundant.pdf")
plot_results(overlap_results = results_out, query_name="CpGs outside CGIs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/CGI_in_vs_out/BG4s_K562/Levine_out_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/CGI_in_vs_out/BG4s_K562/Levine_out_coeff_dist.pdf",
figure_name_CGI_dist="out/CGI_in_vs_out/BG4s_K562/redundant.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = T)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/BG4s_K562/Levine_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/BG4s_K562/Levine_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="BG4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_K562/Levine_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_K562/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_K562/Levine_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="BG4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_K562/Levine_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_K562/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_K562/Levine_neg_CGI_context_dist.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = F)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/BG4s_K562/Levine_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/BG4s_K562/Levine_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="BG4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_K562/Levine_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_K562/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_K562/Levine_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="BG4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_K562/Levine_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_K562/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_K562/Levine_neg_CGI_context_dist.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = F)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/BG4s_K562/Horvath_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/BG4s_K562/Horvath_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_K562/Horvath_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_K562/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_K562/Horvath_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_K562/Horvath_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_K562/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_K562/Horvath_neg_CGI_context_dist.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = T)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/BG4s_HEK/rep1_Horvath_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/BG4s_HEK/rep1_Horvath_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_HEK/rep1_Horvath_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_HEK/rep1_redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_HEK/rep1_Horvath_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_HEK/rep1_Horvath_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_HEK/rep1_redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_HEK/rep1_Horvath_neg_CGI_context_dist.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = T)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/BG4s_HEK/rep1_Levine_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/BG4s_HEK/rep1_Levine_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_HEK/rep1_Levine_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_HEK/rep1_redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_HEK/rep1_Levine_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_HEK/rep1_Levine_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_HEK/rep1_redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_HEK/rep1_Levine_neg_CGI_context_dist.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = T)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/BG4s_HEK/rep2_Levine_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/BG4s_HEK/rep2_Levine_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_HEK/rep2_Levine_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_HEK/rep2_redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_HEK/rep2_Levine_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_HEK/rep2_Levine_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_HEK/rep2_redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_HEK/rep2_Levine_neg_CGI_context_dist.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = T)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/BG4s_HEK/rep2_Horvath_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/BG4s_HEK/rep2_Horvath_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_HEK/rep2_Horvath_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_HEK/rep2_redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_HEK/rep2_Horvath_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_HEK/rep2_Horvath_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_HEK/rep2_redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_HEK/rep2_Horvath_neg_CGI_context_dist.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = T)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/BG4s_hacat/Horvath_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/BG4s_hacat/Horvath_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_hacat/Horvath_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_hacat/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_hacat/Horvath_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_hacat/Horvath_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_hacat/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_hacat/Horvath_neg_CGI_context_dist.pdf")
# load config.json file
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = T)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/BG4s_hacat/Levine_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/BG4s_hacat/Levine_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_hacat/Levine_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_hacat/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_hacat/Levine_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/BG4s_hacat/Levine_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/BG4s_hacat/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/BG4s_hacat/Levine_neg_CGI_context_dist.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = F)
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = F)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/gw_G4s/Horvath_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/gw_G4s/Horvath_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/gw_G4s/Horvath_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/gw_G4s/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/gw_G4s/Horvath_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/gw_G4s/Horvath_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/gw_G4s/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/gw_G4s/Horvath_neg_CGI_context_dist.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = F)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/gw_G4s/Horvath_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/gw_G4s/Horvath_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/gw_G4s/Horvath_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/gw_G4s/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/gw_G4s/Horvath_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/gw_G4s/Horvath_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/gw_G4s/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/gw_G4s/Horvath_neg_CGI_context_dist.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = F)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/gw_G4s/Horvath_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/gw_G4s/Horvath_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/gw_G4s/Horvath_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/gw_G4s/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/gw_G4s/Horvath_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/gw_G4s/Horvath_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/gw_G4s/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/gw_G4s/Horvath_neg_CGI_context_dist.pdf")
params <- fromJSON(file="config.json")
CpG_file <- params[["CpG_file"]]
G4_file_plus <- params[["G4_file_plus"]]
G4_file_minus <- params[["G4_file_minus"]]
chain_file <- params[["chain_file"]]
genome_file <- params[["genome_file"]]
CGI_map_file <- params[["CGI_map_file"]]
window_size_CpG_dist_plot <- params[["window_size_CpG_dist_plot"]]
window_sizes <- params[["window_sizes"]]
all_CpGs_file <- params[["all_CpGs_file"]]
all_CpGs_props_file <- params[["all_CpGs_props_file"]]
G4_locs <- load_G4_data(G4_file_plus, narrow_peak = F)
CpG_locs <- load_CpG_data(CpG_file = CpG_file)
CpG_locs <- lift_over(coordinates=CpG_locs, chain_file=chain_file)
CpG_locs <- annotate_CpGs(CpG_coordinates=CpG_locs, CGI_map_file=CGI_map_file)
CpGs_pos <- CpG_locs %>% filter(coefficient > 0)
CpGs_neg <- CpG_locs %>% filter(coefficient < 0)
results_all_CpGs <- read.csv(file=all_CpGs_props_file, header=T, sep=";")
results_pos <- analyse_window_size(query=CpGs_pos, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
results_neg <- analyse_window_size(query=CpGs_neg, search_set=G4_locs, genome_file=genome_file, window_sizes=window_sizes, all_CpGs_props=results_all_CpGs)
write.table(results_pos$stats, file="out/pos_vs_neg/gw_G4s/Levine_pos_stats.csv", sep=";", quote=F, row.names = F)
write.table(results_neg$stats, file="out/pos_vs_neg/gw_G4s/Levine_neg_stats.csv", sep=";", quote=F, row.names = F)
plot_results(overlap_results = results_pos, query_name="positive CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/gw_G4s/Levine_pos_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/gw_G4s/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/gw_G4s/Levine_pos_CGI_context_dist.pdf")
plot_results(overlap_results = results_neg, query_name="negative CpGs", search_set_name="G4s",
window_size=window_size_CpG_dist_plot,
figure_name_window_size="out/pos_vs_neg/gw_G4s/Levine_neg_ws_vs_enrichment.pdf",
figure_name_coeff_dist="out/pos_vs_neg/gw_G4s/redundant.pdf",
figure_name_CGI_dist="out/pos_vs_neg/gw_G4s/Levine_neg_CGI_context_dist.pdf")
