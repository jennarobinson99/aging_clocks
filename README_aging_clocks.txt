Directory structure:
    data/ -> Contains all the data needed for analysis: aging clock CpG lists and global CpG lists (CpG_lists/), whole-genome G4 and BG4-ChIP data (G4_maps/), chain files for lift over of genome assemblies (chain_files/), maps of CpG islands in the genome (CGI_maps/) and genome files specifying the size of each chromosome which is required for bedtools shuffle (genome_files/).
    out/ -> Output directory containing all final outputs of scripts.
    temp/ -> Directory containing all temporarily produced data, NOT final results.
    sequences/ -> Contains all sequences (fasta format) that need to be analysed by other tools (e.g. MEME analysis).
    R_scripts/ -> Contains all scripts written in R.
    sh_scripts/ -> Contains all scripts written for Bash including the main workflow scripts.

Description of scripts for Bash:
*** NOTE: The Bash scripts are used to automate the workflow between scripts (Bash and R scripts). They are usually written in pairs, one iterating through various window sizes (control script c) and the other one executing the overlap an analysis for a given window size (overlap script o). ***
    0) config.sh -> This file is read by the control script to specify all inputs (e.g. input file name, output file name, chain file, ...) except the window sizes.
    1) analyse_window_size.sh (c) & CpG_G4_overlap.sh (o) -> Executes standard overlap analysis of a set of aging clock CpGs with a set of G4s. Fold enrichment can be calculated as overlaps between G4s and AC CpGs divided by shuffled version of either within the whole genome (e.g. AC CpGs within G4s vs. random distribution of AC CpGs throughout the genome). Alternatively if the parameter CpG_vs_CGI in config.sh is set to 1, the enrichment is calculated by dividing through G4 overlaps with CpGs shuffled within known CGI islands (only available for human clocks). This may elsewhere be referred to as the "pseudo-CGIs" method. Output file contains fold enrichment as well as number of G4s and CpGs overlapping.
    2) AC_CpG_vs_global_CpG.sh (c) & AC_CpG_vs_global_CpG_overlap.sh (o) -> Overlaps G4s with AC CpGs and G4s with all CpGs in the genome. It outputs both the fold enrichment of G4s at AC CpG sites and the fold enrichment of G4s at all CpGs in the genome.
    3) global_CpG_vs_G4.sh (c) & global_CpG_vs_G4_overlap.sh (o) -> Overlaps AC CpGs with G4s and all CpGs in the genome with G4s. Outputs fold enrichment of AC CpGs at G4s and all CpGs at G4s (reverse overlap than 2).00
    4) separate_CGI_context (c) & contextual_overlap.sh (o) -> Separates CpGs according to CGI context and overlaps both separately with G4s. Outputs the fold enrichment of these CpG sub-lists calculated with respect to random shuffled CpGs in G4s.
    5) CGI_FE.sh (c) & CGI_G4_overlap.sh (o) -> Overlaps G4s with CpG islands and gives the fold enrichment of G4s in CpG islands with respect to random distribution of G4s throughout the genome.

Description of scripts in R:
*** NOTE: The following scripts are designed to be used from the command line and usually are interfaced by Bash scripts which control the higher level workflow (see "Description of scripts for Bash") ***
    Preprocessing for overlap analysis:
        csv_to_bed.R -> converts an input file from .csv format to .bed format.
        lift_over.R -> lifts over genome coordinates of input file, using a supplied chain file (e.g. needed to go from hg18 -> hg19). hg19 is the standard assembly used in this project.
        filter_CpGs.R -> splits up the supplied CpG lists according to positive / negative correlation and CGI context (inside / outside CpG island) and saves all generated sub-lists into temp/ directory.
    Analysis of overlap results:
        analyse_overlap_results.R -> takes in output file of overlap analysis (e.g. fold enrichment file, CpG and G4 lists) and plots the enrichment against all window sizes tested. Also generates bar charts showing the distribution of overlapping CpGs between positive/negative correlation and inside/outside CGIs.
        CGI_context_results.R -> Plots the fold enrichment at given window size and CpG distributions for the specific case of analysing CpGs within CGIs and CpGs outside CGIs separately.

*** NOTE: The following scripts are designed to be used in interactive mode (e.g. RStudio) and are independent of other scripts. ***
    Miscellaneous:
        G4_map_exploration.R -> generates some key statistics on the given G4 data. Used for initial data exploration.
        CpG_distance.R -> generates some key statistics on the given CpG lists. Used for initial data exploration.
        find_all_CpGs.R -> finds all CpGs within a genome and generates a file containing their genome coordinates extended by a chosen window size.
        find_sequences.R -> takes in a list of genome coordinates (e.g. generated by find_all_CpGs.R) and finds their corresponding sequences. The sequences are saved in .fasta format in the sequences/ directory.

Miscellaneous:
Workflow for DNAm clock CpG analysis

MEME analysis:
1) Obtain list of CpG sites (genomic coordinates, chromosome number) in form of
    .csv or similar
2) Extend single CpGs to genomic ranges of n bases around each CpG and convert
    to .bed file (script csv_to_bed.R).
3) If using older genome assembly data, convert genome coordinates to
    appropriate (e.g. most recent) assembly using LiftOver
    (https://genome.ucsc.edu/cgi-bin/hgLiftOver) on .bed files.
4) Obtain respective DNA sequences from genome coordinates data (.bed file)
    using script find_sequences.R and save as .fasta file (using BSgenome, Biostrings
    and seqinr packages in R).
5) Queue up MEME job with your .fasta file on website (https://meme-suite.org/meme/info/status?service=MEME&id=appMEME_5.3.316142543884241624959992)

G4 overlap analysis:
1) Get data from GEO (https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE110582)
2) Intersect CpGs with G4s using bedtools intersect -wa
3) Explore overlap data: Correlation coeff of overlapping CpGs, number of overlaps, Differential enrichment against control case (all CpGs).

Control case:
1) Using BSgenome, get hg38 and extract all CpGs in sequence
Note: Only perfect matches, excludes SNPs or other mutations.
